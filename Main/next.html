<!DOCTYPE html>
<html>
    <head>
        <title>Placeholder Title V2</title>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="css/next.css">
    </head>
    <body>
        <form id="secondForm">
            <button type="button" onclick="goBack()"><strong>‚Üê Go Back</strong></button>
        </form>
        <div id="resultsTable">
            <h2>Recommended Route</h2>
            <p id="API-info">Loading...</p>
        </div>
        <script src="js/animation.js"></script>
        <script>
            async function sendPostRequest() {
                try {
                    // Retrieve data from local storage
                    const topics = JSON.parse(localStorage.getItem('topics')) || [];
                    const main_topic = localStorage.getItem('main_topic') || '';

                    // Data to be sent in the POST request
                    const data = {
                        topics: topics,
                        main_topic: main_topic
                    };

                    // Send POST request
                    const response = await fetch("http://localhost:8000/generate_study_plan", {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(data)
                    });

                    // Check if the request was successful
                    if (response.ok) {
                        // Parse the JSON response
                        const studyPlan = await response.json();
                        const plan = studyPlan.study_plan;

                        console.log("Study Plan:");
                        console.log(plan);

                        // Set the innerHTML of the p tag with id API-info
                        document.getElementById("API-info").innerHTML = plan.replace(/\n/g, '<br>');
                    } else {
                        console.error(`Error: ${response.status}`);
                        console.error(await response.text());
                    }
                } catch (error) {
                    console.error(`An error occurred: ${error}`);
                }
            }

            // Run the function
            sendPostRequest();
        </script>
    </body>
</html>
